#include <bits/stdc++.h>
using namespace std;

int main(){
  int n, m, k, ans=0;
  cin >> m >> n >> k; //輪盤格數，幾個輪盤，各轉幾次
  vector<string> len(m); //輪盤字串
  vector<string> newLen(m); //轉完的字串
  vector<vector<int>> move(k, vector<int>(m)); //轉動
  for(int i=0; i<m; i++) {
    cin >> len[i];
  }
  for(int i=0; i<k; i++) {
    for(int j=0; j<m; j++) {
      cin >> move[i][j]; //"i"為第幾次轉動，"j"為第幾個輪盤
    }
  }
  for(int i=0; i<k; i++) { 
    for(int j=0; j<m; j++) {//轉動
      move[i][j]%=n;
      if(move[i][j]<0) move[i][j]+=n;
      if(i==0) newLen[j] = len[j].substr(n - move[i][j]) + len[j].substr(0, n - move[i][j]);
      else newLen[j] = newLen[j].substr(n - move[i][j]) + newLen[j].substr(0, n - move[i][j]);
    }
    vector<string> VS(n); 
    for(int z=0; z<n; z++) { //比較出現次數
      VS.clear();
      int words[26] = {0};
      for(int j=0; j<m; j++) {
        VS[z].push_back(newLen[j][z]);
      }
      for(int j=0; j<m; j++) {
        char c = VS[z][j]; 
        words[c - 'a']++;
      }
      sort(words, words+26);
      ans += words[25];
    }
  }
  cout << ans << "\n";
  return 0;
}
